% Use must pass options to xcolor like this (pure LaTeX)
%     \PassOptionsToPackage{natural,usenames,svgnames}{xcolor}
% or like this (org-mode export)
%     #+LATEX_CLASS_OPTIONS: [...,natural,usenames,svgnames]
\RequirePackage{listings}
\RequirePackage{xcolor}

\definecolor{DefaultColor}{RGB}   {0, 0, 0}
\definecolor{IdentifierColor}{RGB}{10, 100, 10}
\definecolor{NumberColor}{RGB}    {5, 171, 2}
\definecolor{StringColor}{RGB}    {201, 124, 101}
\definecolor{CommentColor}{RGB}   {139,69,19}
\definecolor{KeywordColor}{RGB}   {122, 17, 182}
\definecolor{Keyword2Color}{RGB}  {239, 127, 75}
\definecolor{Keyword3Color}{RGB}  {25, 118, 210}
\definecolor{Keyword4Color}{RGB}  {11, 186, 44}
\definecolor{OperatorColor}{RGB}  {175, 80, 43}


%%
%% Yaml definition
%% (c) 2025 Michel Briand
%%
\lstdefinelanguage{Yaml}{
  emph={True,False},
  sensitive=false,
  morecomment=[l]\#,
  morestring=[b]',
  morestring=[b]"
}


%%
%% Ansible definition
%% (c) 2025 Michel Briand
%%
\lstdefinelanguage{Ansible}{
  alsolanguage=Yaml,
  moreemph={all},
  emphstyle=\color{IdentifierColor},
  commentstyle=\color{CommentColor},
  numberstyle=\tiny\color{NumberColor},
  stringstyle=\color{StringColor},
  basicstyle=\ttfamily\color{DefaultColor},
  breakatwhitespace=false,
  breaklines=true,
  captionpos=b,
  keepspaces=true,
  numbers=left,
  numbersep=5pt,
  showspaces=false,
  showstringspaces=false,
  showtabs=false,
  tabsize=2,
  % general
  morekeywords={
    hosts,
    remote_user,
    gather_facts,
    tasks
  },
  keywordstyle=\color{KeywordColor},
  % important keywords for control
  morekeywords = [2]{become,when,loop,with_items,register},
  keywordstyle = [2]\color{Keyword2Color},
  % parameters
  morekeywords = [3]{debug,state,var,package,service},
  keywordstyle = [3]\color{Keyword3Color},
  % name
  morekeywords = [4]{name},
  keywordstyle = [4]\color{Keyword4Color},
}


%%
%% Json definition
%% https://tex.stackexchange.com/a/433961/209542
%% https://tex.stackexchange.com/questions/83085/how-to-improve-listings-display-of-json-files
%% TODO: test this
%% https://tex.stackexchange.com/a/569146/209542

\lstdefinelanguage{json}{
    % there is no comment in json
    basicstyle=\ttfamily,
    numbers=left,
    numberstyle=\scriptsize\color{NumberColor},
    breaklines=true,
    %frame=lines,
    %backgroundcolor=\color{gray!10},
    showstringspaces=false,
    morestring=[db]{"},
    stringstyle=\color{StringColor},
    morestring=[s][\color{KeywordColor}]{\ \ "}{":},
    keywordstyle=\color{KeywordColor},
    moreemph={true,false,null},
    emphstyle=\color{IdentifierColor},
    literate=
     *{0}{{{\color{NumberColor}0}}}{1}
      {1}{{{\color{NumberColor}1}}}{1}
      {2}{{{\color{NumberColor}2}}}{1}
      {3}{{{\color{NumberColor}3}}}{1}
      {4}{{{\color{NumberColor}4}}}{1}
      {5}{{{\color{NumberColor}5}}}{1}
      {6}{{{\color{NumberColor}6}}}{1}
      {7}{{{\color{NumberColor}7}}}{1}
      {8}{{{\color{NumberColor}8}}}{1}
      {9}{{{\color{NumberColor}9}}}{1}
      {.}{{{\color{red}.}}}{1}
      {:}{{{\color{gray}{:}}}}{1}
      {,}{{{\color{gray}{,}}}}{1}
      {\{}{{{\color{gray}{\{}}}}{1}
      {\}}{{{\color{gray}{\}}}}}{1}
      {[}{{{\color{gray}{[}}}}{1}
      {]}{{{\color{gray}{]}}}}{1},
}

%%
%% Ini/conf definition
%% 
%%

\lstdefinelanguage{conf}
{
  basicstyle=\ttfamily\footnotesize,
  morecomment=[l]{\#},
  morecomment=[l]{;},
  commentstyle=\color{CommentColor},
  morestring=[b]',
  morestring=[b]",
  stringstyle=\color{StringColor},
  literate=*%
    {=}{{{\color{OperatorColor}{=}}}}{1},%
  morekeywords=[1]{
    inventory,
    callbacks_enabled,
    stdout_callback
  },
  keywordstyle=[1]\color{KeywordColor}
}
